## Отличия от предыдущей версии

1. Я постарался перенести всё это на class-based view, не могу сказать,
что получилось идеально, но что-то всё-таки получилось
2. Фильтрация комнат теперь реализована при помощи django-filters, признаюсь честно, это мой первый проект на django 
и про существование django-filters я не знал до первой сдачи задания
3. Добавлен JWTAuthenticationMiddleware и теперь логика запросов авторизованных пользователей 
обрабатывается с его помощью
4. Я попробовал реализовать тесты при помощи APITestCase, теперь они выглядят не так страшно.
Запуск тестов - ```./manage.py test app.tests```
5. Комментарий по поводу внешней бд я услышал, однако не успел подружить django с mysql, прошу простить
6. Тесты выполняются в отдельной sqlite3 бд
7. Был комментарий по поводу того, что обычно файлы статики не добавляются в репозиторий, если я правильно вас понял, 
то папка static была добавлена в репозиторий для отрисовки админки через плагин Grapelli
## Инструкция по установке
1. Склонировать репозиторий
```
git clone https://github.com/Gendorosan/MyLittleHotel.git
```
2. Перейти в папку проекта, подгрузить зависимости
```
python -m pip install -r requirements.txt
```
3. Перейти в директорию src и запустить сервер
```
python manage.py runserver
```
4. Вы великолепны, можете посетить админку сайта - http://127.0.0.1:8000/admin/

p.s. база данных находится на удаленном хосте, поэтому с ней делать ничего не надо

## Api MyLittleHottel имеет следующие эндпоинты:

---
## *admin/* 
Вход в админку отеля

Для проверки решения используйте следующие данные:
```
Логин - gendor
Пароль - q1w2e3
```
Админ умеет добавлять/удалять/редактировать комнаты и
редактировать записи о бронях через админ панель Django


---
## *api/registration* 
Регистрация клиента

Это **POST** запрос, который принимает на вход следующие параметры:
```
{
    'login': login,
    'password': password,
    'name': 'Ivan',
    'phone_number': '88005553535',
    'email': 'email@mail.ru'
}
```

Если регистрация прошла успешно, то вернется jwt токен, который в дальнейшем будет передаваться в запросах,
исходящих от авторизованного а клиента
```
{
   "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dpbiI6InF3ZXJ0eSJ9.Xvdu_WJtN7McLcwL0LkdQKQM1PWwUhEfQJPC5w-UgrM"
}
```
В случае, когда пользователь с таким логином уже существует, вернется код 400
```
{
    "code": 400,
    "message": "Such login already exists"
}
```
---
## *api/authentication* 
Аутентификация клиента

Это **POST** запрос, который принимает на вход следующие параметры:
```
{
    'login': login,
    'password': password,
}
```

Если аутентификация прошла успешно, то вернется jwt токен
```
{
   "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dpbiI6InF3ZXJ0eSJ9.Xvdu_WJtN7McLcwL0LkdQKQM1PWwUhEfQJPC5w-UgrM"
}
```
---
## *api/all_rooms*
Список всех комнат отеля 

Это **GET** запрос, который возвращает ответ в следующем виде:
```
[
    {
        "room_id": 1,
         "name": "luxe",
          "cost": "10000.00",
           "seating_capacity": 1
    }, 
    {
        "room_id": 2,
         "name": "luxe2",
          "cost": "10500.00",
           "seating_capacity": 1
    }
]
```
---
## *api/room_filter*
Список комнат, отсортированный по указанным в url правилам

Это **GET** запрос, который возвращает ответ в следующем виде:
```
[
    {
        "room_id": 1,
         "name": "luxe",
          "cost": "10000.00",
           "seating_capacity": 1
    }, 
    {
        "room_id": 2,
         "name": "luxe2",
          "cost": "10500.00",
           "seating_capacity": 1
    }
]

```
---

## *api/get_free_rooms* 
Список всех свободных комнат в заданном промежутке

Это **GET** запрос, который возвращает ответ в следующем виде:
```
[
    {
        "room_id": 1,
         "name": "luxe",
          "cost": "10000.00",
           "seating_capacity": 1
    }, 
    {
        "room_id": 2,
         "name": "luxe2",
          "cost": "10500.00",
           "seating_capacity": 1
    }
]
```
---
## *api/get_reserved_rooms* 
Комнаты, зарезервированные клиентом

Это **POST** запрос, который принимает на вход следующие параметры:
```
{
    'login': login,
}
```
Для того чтобы данный запрос мог исходить только от авторизированного пользователя,
сервер ожидает увидеть в заголовке запроса jwt токен
```
"Authorization": jwt_token
```
Если его там не будет, то сервер вернет код 400
```
{
    "code": 400, 
    "message": "Validation Failed"
}
```
Ответ сервера для авторизованного пользователя:
```
[
    {
        "room_id": 1,
         "name": "luxe",
          "cost": "10000.00",
           "seating_capacity": 1
    }
]
```
---
## *api/cancel_reservation* 
отмена брони комнаты

Это **POST** запрос, который принимает на вход следующие параметры:
```
{
    'login': login,
    'room_name': 'Люкс №2',
    'start_date': '2022-10-5',
    'end_date': '2022-10-7'
}
```
**Логика проверки авторизации как в api/get_reserved_rooms**

```
{
   "code": 200,
   "message": "Room reserved successfully"
}
```
---
## *api/create_reservation* 
создание брони комнаты

Это **POST** запрос, который принимает на вход следующие параметры:
```
{
    'login': login,
    'room_name': 'Люкс №2',
    'start_date': '2022-10-5',
    'end_date': '2022-10-7'
}
```
**Логика проверки авторизации как в api/get_reserved_rooms**


```
{
   "code": 200,
   "message": "Success"
}
```
---
